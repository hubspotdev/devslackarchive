[
  {
    "text": "<@U034SLUH0UV> *Please consider that the search engines automatically link to the related language version of a page.* The scenario I imagine is, when you link from an English page to a German page, and have no option to set the link target or pass a language parameter. And even if you do the redirect, _search engines recognize it and punish your ranking_! But if you still want to do it, you have to look for the base language of the browser:\n\n\n*STEP 1 - Get the Browser Language with HubL*\n\nCountry codes for English and German:\n```{% set countryCodes = {'en':'en','en-au':'en','en-ca':'en','en-hk':'en','en-in':'en','en-ie':'en','en-my':'en','en-mt':'en','en-nz':'en','en-ph':'en','en-sg':'en','en-za':'en','en-gb':'en','en-us':'en','en-zw':'en','de':'de','de-at':'de','de-de':'de','de-gr':'de','de-li':'de','de-lu':'de','de-ch':'de'} %}```\nLookup browser user language in country codes. Fallback is `en`.\n```{% set user_language = request.headers['accept-language']|split(',')|map('lower') %}\n{% set base_language = countryCodes[user_language[0]] || countryCodes[user_language[1]|split(';')|first] || 'en' %}```\nThe `base_language` variable is now for all browser languages `de` or `en`.\n\n\n*STEP 2 - Do Not Redirect if page is open in the HubSpot Editor* \n\nTo find out if the page is shown in an editor or preview way, we check all the case URLs from HubSpot:\n```{%- set iframe = {\n  template: ('template_file_path' in request.query) ? true : false, \n  module: ('module_id' in request.query) ? true : false,\n  editor: ('inpageEditorUI' in request.query) ? true : false,\n  preview: ('isPreview' in request.query) ? true : false,\n  backend: ('/edit/' in request.path) ? true : false,\n  staging: ('hs_preview' in request.query) ? true : false\n} -%}```\nAnd determinant if the page is open by any kind of preview or HubSpot editor:\n```{%- if 'HubSpotpreview' in request.domain and (iframe.template or iframe.module or iframe.editor or iframe.preview) or iframe.backend -%}\n  {%- set preview = true -%}\n{%- else -%}\n  {%- set preview = false -%}\n{%- endif -%}```\n\n*STEP 3 - Execute Redirect with JavaScript*\n\nTo-do the redirect itself, I prefer a micro-modul, because it's better to check if the directed page exist before redirecting to it. And you want to prevent the redirect for eventual endless loops or redirect twice by setting a query parameter to the URL. As well, place everything with `require_css` in the document head to be executed as early as possible.\n\n```{% if base_language == 'de' and module.redirect_page_id and 'redirect' not in request.query and !preview %}\n  {% require_css %}\n    &lt;script&gt;\n      window.location.href = {{ '\"'~ content_by_id(module.redirect_page_id).absolute_url ~'?redirect=true\"' }};\n    &lt;/script&gt;\n  {% end_require_css %}\n{% endif %}```\n*But please, again, redirect with JavaScript is a bad solution, you should not do that. This is not the way how multi-language website usually work! So please check any other option before getting back to a JavaScript redirect. This should stay the really last way out!*",
    "time_stamp": "2022-06-17 01:36:06"
  },
  {
    "poster": {
      "poster_name": "Girdhari Sharma",
      "poster_handle": "girdharisharma192"
    },
    "time_stamp": "2022-06-17 03:36:09",
    "text": "<@UK9BKNBD5> Thanks for your help.\n\nMy query has been done by this code.\n\n &lt;script&gt;\n  $( document ).ready(function(){\n        var userLang = navigator.language;\n       var finlang = localStorage.getItem(\"userLang\");\n\n        if (userLang == \"de\" &amp;&amp; finlang !=\"de\") {\n       localStorage.setItem(\"userLang\", \"de\");\n       window.location.href = \"<https://www.example.com/de>\";\n\n        }\n    else{\n     localStorage.setItem(\"userLang\", \"en\");\n    }\n});\n        &lt;/script&gt;"
  }
]